name: PS2 Test deploy
on:
  push:
    branches:
      - test
      - feat/split-job-deploy

jobs:
  build:
    name: PS2 Test Build
    uses: ./.github/workflows/ps2-wl-build.yml
    secrets: inherit
    with:
      deploy-env: test
  cdn:
    name: PS2 Test CDN Deploy
    uses: ./.github/workflows/ps2-wl-cdn.yml
    needs:
      - build
    secrets: inherit
    with:
      deploy-env: test
  codedeploy:
    name: PS2 Test Codedeploy Deploy
    uses: ./.github/workflows/ps2-wl-codedeploy.yml
    needs:
      - build
    secrets: inherit
    with:
      deploy-env: test
  cache:
    name: PS2 Test Cache clear
    needs:
      - cdn
      - codedeploy
    uses: ./.github/workflows/ps2-wl-cache-nuke.yml
    secrets: inherit
    with:
      deploy-env: test
